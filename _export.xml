<datapower-configuration version="3">
    <export-details>
        <description>Exported Configuration</description>
        <user>admin</user>
        <domain>APIC-System</domain>
        <product-id>5725</product-id>
        <product>IDG</product>
        <display-product>IDG</display-product>
        <model>IBM DataPower Gateway</model>
        <display-model>IBM DataPower Gateway</display-model>
        <serial-number>0000000</serial-number>
        <firmware-version>IDG.7.7.0.2</firmware-version>
        <display-firmware-version>IDG.7.7.0.2</display-firmware-version>
        <firmware-build>298364</firmware-build>
        <firmware-timestamp>2018/04/17 15:33:37</firmware-timestamp>
    </export-details>
    <configuration domain="APIC-System">
        <StylePolicyAction name="&PROJNAME;-run" xmlns:env="http://www.w3.org/2003/05/soap-envelope" xmlns:dp="http://www.datapower.com/schemas/management">
            <mAdminState>enabled</mAdminState>
            <Type>gatewayscript</Type>
            <Input>INPUT</Input>
            <GatewayScriptLocation>local:///policy/&PROJNAME;/&PROJNAME;.js</GatewayScriptLocation>
            <ActionDebug persisted="false">off</ActionDebug>
            <Output>INPUT</Output>
            <NamedInOutLocationType>default</NamedInOutLocationType>
            <SSLClientConfigType>proxy</SSLClientConfigType>
            <Transactional>off</Transactional>
            <SOAPValidation>body</SOAPValidation>
            <SQLSourceType>static</SQLSourceType>
            <JWSVerifyStripSignature>on</JWSVerifyStripSignature>
            <Asynchronous>off</Asynchronous>
            <ResultsMode>first-available</ResultsMode>
            <RetryCount>0</RetryCount>
            <RetryInterval>1000</RetryInterval>
            <MultipleOutputs>off</MultipleOutputs>
            <IteratorType>XPATH</IteratorType>
            <Timeout>0</Timeout>
            <MethodRewriteType>GET</MethodRewriteType>
            <MethodType>POST</MethodType>
            <MethodType2>POST</MethodType2>
        </StylePolicyAction>

        <StylePolicyAction name="&PROJNAME;-check-media-type" xmlns:env="http://www.w3.org/2003/05/soap-envelope" xmlns:dp="http://www.datapower.com/schemas/management">
            <mAdminState>enabled</mAdminState>
            <Type>xform</Type>
            <Input>NULL</Input>
            <Transform>local:///policy/&PROJNAME;/is-json.xsl</Transform>
            <ActionDebug persisted="false">off</ActionDebug>
            <Output>is-json</Output>
            <NamedInOutLocationType>default</NamedInOutLocationType>
            <SSLClientConfigType>proxy</SSLClientConfigType>
            <OutputType>default</OutputType>
            <Transactional>off</Transactional>
            <SOAPValidation>body</SOAPValidation>
            <SQLSourceType>static</SQLSourceType>
            <JWSVerifyStripSignature>on</JWSVerifyStripSignature>
            <Asynchronous>off</Asynchronous>
            <ResultsMode>first-available</ResultsMode>
            <RetryCount>0</RetryCount>
            <RetryInterval>1000</RetryInterval>
            <MultipleOutputs>off</MultipleOutputs>
            <IteratorType>XPATH</IteratorType>
            <Timeout>0</Timeout>
            <MethodRewriteType>GET</MethodRewriteType>
            <MethodType>POST</MethodType>
            <MethodType2>POST</MethodType2>
        </StylePolicyAction>
        <HTTPInputConversionMap name="&PROJNAME;-json-input-enc" xmlns:env="http://www.w3.org/2003/05/soap-envelope" xmlns:dp="http://www.datapower.com/schemas/management">
            <mAdminState>enabled</mAdminState>
            <DefaultInputEncoding>json</DefaultInputEncoding>
        </HTTPInputConversionMap>
        <StylePolicyAction name="&PROJNAME;-json2jsonx" xmlns:env="http://www.w3.org/2003/05/soap-envelope" xmlns:dp="http://www.datapower.com/schemas/management">
            <mAdminState>enabled</mAdminState>
            <Type>convert-http</Type>
            <Input>INPUT</Input>
            <ActionDebug persisted="false">off</ActionDebug>
            <Output>INPUT</Output>
            <NamedInOutLocationType>default</NamedInOutLocationType>
            <InputConversion class="HTTPInputConversionMap">&PROJNAME;-json-input-enc</InputConversion>
            <SSLClientConfigType>proxy</SSLClientConfigType>
            <Transactional>off</Transactional>
            <SOAPValidation>body</SOAPValidation>
            <SQLSourceType>static</SQLSourceType>
            <JWSVerifyStripSignature>on</JWSVerifyStripSignature>
            <Asynchronous>off</Asynchronous>
            <ResultsMode>first-available</ResultsMode>
            <RetryCount>0</RetryCount>
            <RetryInterval>1000</RetryInterval>
            <MultipleOutputs>off</MultipleOutputs>
            <IteratorType>XPATH</IteratorType>
            <Timeout>0</Timeout>
            <MethodRewriteType>GET</MethodRewriteType>
            <MethodType>POST</MethodType>
            <MethodType2>POST</MethodType2>
        </StylePolicyAction>
        <StylePolicyAction name="&PROJNAME;-condition-if-json" xmlns:env="http://www.w3.org/2003/05/soap-envelope" xmlns:dp="http://www.datapower.com/schemas/management">
            <mAdminState>enabled</mAdminState>
            <Type>conditional</Type>
            <Input>is-json</Input>
            <InputLanguage>json</InputLanguage>
            <TransformLanguage>xquery</TransformLanguage>
            <ActionDebug persisted="false">off</ActionDebug>
            <TxMode>default</TxMode>
            <NamedInOutLocationType>default</NamedInOutLocationType>
            <SSLClientConfigType>proxy</SSLClientConfigType>
            <OutputType>default</OutputType>
            <Transactional>off</Transactional>
            <SOAPValidation>body</SOAPValidation>
            <SQLSourceType>static</SQLSourceType>
            <JOSESerializationType>compact</JOSESerializationType>
            <JWEEncAlgorithm>A128CBC-HS256</JWEEncAlgorithm>
            <JOSEVerifyType>identifiers</JOSEVerifyType>
            <JOSEDecryptType>identifiers</JOSEDecryptType>
            <JWSVerifyStripSignature>on</JWSVerifyStripSignature>
            <Asynchronous>off</Asynchronous>
            <Condition>
                <Expression>/info/is-json[normalize-space(.) = 'true']</Expression>
                <ConditionAction>&PROJNAME;-json2jsonx</ConditionAction>
            </Condition>
            <ResultsMode>first-available</ResultsMode>
            <RetryCount>0</RetryCount>
            <RetryInterval>1000</RetryInterval>
            <MultipleOutputs>off</MultipleOutputs>
            <IteratorType>XPATH</IteratorType>
            <Timeout>0</Timeout>
            <MethodRewriteType>GET</MethodRewriteType>
            <MethodType>POST</MethodType>
            <MethodType2>POST</MethodType2>
        </StylePolicyAction>
        <StylePolicyAction name="&PROJNAME;-output" xmlns:env="http://www.w3.org/2003/05/soap-envelope" xmlns:dp="http://www.datapower.com/schemas/management">
            <mAdminState>enabled</mAdminState>
            <Type>xform</Type>
            <Input>INPUT</Input>
            <Transform>store:///identity.xsl</Transform>
            <ActionDebug persisted="false">off</ActionDebug>
            <Output>OUTPUT</Output>
            <NamedInOutLocationType>default</NamedInOutLocationType>
            <SSLClientConfigType>proxy</SSLClientConfigType>
            <OutputType>default</OutputType>
            <Transactional>off</Transactional>
            <SOAPValidation>body</SOAPValidation>
            <SQLSourceType>static</SQLSourceType>
            <JWSVerifyStripSignature>on</JWSVerifyStripSignature>
            <Asynchronous>off</Asynchronous>
            <ResultsMode>first-available</ResultsMode>
            <RetryCount>0</RetryCount>
            <RetryInterval>1000</RetryInterval>
            <MultipleOutputs>off</MultipleOutputs>
            <IteratorType>XPATH</IteratorType>
            <Timeout>0</Timeout>
            <MethodRewriteType>GET</MethodRewriteType>
            <MethodType>POST</MethodType>
            <MethodType2>POST</MethodType2>
        </StylePolicyAction>
        
        <StylePolicyRule name="&PROJNAME;-main" xmlns:env="http://www.w3.org/2003/05/soap-envelope" xmlns:dp="http://www.datapower.com/schemas/management">
            <mAdminState>enabled</mAdminState>
            <Actions class="StylePolicyAction">&PROJNAME;-run</Actions>
            <Direction>request-rule</Direction>
            <InputFormat>none</InputFormat>
            <OutputFormat>none</OutputFormat>
            <NonXMLProcessing>off</NonXMLProcessing>
            <Unprocessed>off</Unprocessed>
        </StylePolicyRule>
    </configuration>
    <files>
        <file name="local:///policy/&PROJNAME;/&PROJNAME;.js" src="local/policy/&PROJNAME;/&PROJNAME;.js" location="local" hash="&JSFILEHASH;"/>
        <file name="local:///policy/&PROJNAME;/is-json.xsl" src="local/policy/&PROJNAME;/is-json.xsl" location="local" hash="&ISJSONFILEHASH;"/>
    </files>
</datapower-configuration>